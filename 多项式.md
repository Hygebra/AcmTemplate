# å¤šé¡¹å¼NTT,æ±‚é€†ï¼Œlnï¼Œexpï¼Œå¿«é€Ÿå¹‚

ç»™å®šä¸€ä¸ª $n-1$ æ¬¡å¤šé¡¹å¼ $A(x)$ï¼Œæ±‚ä¸€ä¸ªåœ¨ $\mod x^n$æ„ä¹‰ä¸‹çš„å¤šé¡¹å¼$B(x)$ï¼Œä½¿å¾—$B(x)\equiv (A(x))^k(\mod x^n)$ã€‚

å¤šé¡¹å¼çš„ç³»æ•°åœ¨$\mod 998244353$ çš„æ„ä¹‰ä¸‹è¿›è¡Œè¿ç®—ã€‚

ç¬¬ä¸€è¡Œä¸¤ä¸ªæ•´æ•° $n,k$,æ¥ä¸‹æ¥ $n$ ä¸ªæ•´æ•°ï¼Œä¾æ¬¡è¡¨ç¤º$ A(x)$ çš„ç³»æ•° $a_0,a_1,...,a_{n-1}$ã€‚è¾“å‡º$n$ä¸ªæ•´æ•°ï¼Œä¾æ¬¡è¡¨ç¤º$B(x)$çš„å‰né¡¹ç³»æ•°$b_0,b_1,...,b_{n-1}$åœ¨æ¨¡$998244353$æ„ä¹‰ä¸‹çš„æœ€å°è‡ªç„¶æ•°å€¼ã€‚

```cpp
#include <cstdio>
#include <cstring>
#include <vector>
#include <iostream>
#include <algorithm>
//#define addfa(a,b) ((a)+(b)<mod?(a)+(b):(a)+(b)-mod)
//#define subfa(a,b) ((a)<(b)?(a)-(b)+mod:(a)-(b))
const int S=270000,mod=998244353;
inline void swap(int &a,int &b){int c(a);a=b;b=c;}
inline int ksm(int a,int x)
{
	int s=1;
	while (x)
	{
		if (x&1) s=1ll*a*s%mod;
		x>>=1;
		a=1ll*a*a%mod;
	}
	return s;
}
using poly=std::vector<int>;
namespace _P
{
	int G=3,Gi=ksm(3,mod-2);
	inline void dft(int *a,int lim){
	    for(int i=lim>>1;i;i>>=1)
	        for(int j=0,rt=ksm(G,(mod-1)/(i<<1));j<lim;j+=i<<1)
	            for(int k=0,p=1;k<i;k++,p=1ll*p*rt%mod){
	                int x=a[j+k],y=a[i+j+k];
	                a[j+k]=(x+y)%mod,a[i+j+k]=1ll*p*(x-y+mod)%mod;
	            }
	}
	inline void idft(int *a,int lim){
	    for(int i=1;i<lim;i<<=1)
	        for(int j=0,rt=ksm(Gi,(mod-1)/(i<<1));j<lim;j+=i<<1)
	            for(int k=0,p=1;k<i;k++,p=1ll*p*rt%mod){
	                int x=a[j+k],y=1ll*p*a[i+j+k]%mod;
	                a[j+k]=(x+y)%mod,a[i+j+k]=(x-y+mod)%mod;
	            }
	    for(int i=0,k=ksm(lim,mod-2);i<lim;i++) a[i]=1ll*a[i]*k%mod;
	}
	poly inv(poly const &b){
	    static int tmp[1<<18],ans[1<<18],a[1<<18];
	    int n=b.size();
	    poly res(n);
	    for(int i=0;i<n;i++)a[i]=b[i];
	    int l=n;
	    for(n=1;n<l;n<<=1);
	    ans[0]=ksm(a[0],mod-2);
	    for(int m=2;m<=n;m<<=1){
	        int lim=m<<1;
	        for(int i=0;i<m;i++)tmp[i]=a[i];
	        dft(tmp,lim),dft(ans,lim);
	        for(int i=0;i<lim;i++)ans[i]=ans[i]*(2-1ll*ans[i]*tmp[i]%mod+mod)%mod,tmp[i]=0;
	        idft(ans,lim);
	        for(int i=m;i<lim;i++)ans[i]=0;
	    }
	    for(int i=0;i<l;i++)res[i]=ans[i];
	    for(int i=0;i<(n<<1);i++)ans[i]=a[i]=tmp[i]=0;
	    return res;
	}
	poly mul(poly const &a,poly const &b){
	    int n=a.size(),m=b.size(),lim;
	    poly c(n+m-1);
	    static int foo[1<<18],bar[1<<18];
	    for(int i=0;i<n;i++)foo[i]=a[i];
	    for(int i=0;i<m;i++)bar[i]=b[i];
	    for(lim=1;lim<n+m-1;lim<<=1);
	    dft(foo,lim),dft(bar,lim);
	    for(int i=0;i<lim;++i)foo[i]=1ll*foo[i]*bar[i]%mod;
	    idft(foo,lim);
	    for(int i=0;i<n+m-1;++i)c[i]=foo[i];
	    for(int i=0;i<lim;++i)foo[i]=bar[i]=0;
	    return c;
	}
	poly conv(poly const &a,poly const &b,int lim){
	    int n=a.size(),m=b.size();
	    poly c(lim);
	    static int foo[1<<18],bar[1<<18];
	    for(int i=0;i<n;i++)foo[i]=a[i];
	    for(int i=0;i<m;i++)bar[i]=b[i];
	    dft(foo,lim),dft(bar,lim);
	    for(int i=0;i<lim;++i)foo[i]=1ll*foo[i]*bar[i]%mod;
	    idft(foo,lim);
	    for(int i=0;i<lim;++i)c[i]=foo[i];
	    for(int i=0;i<lim;++i)foo[i]=bar[i]=0;
	    return c;
	}
	poly pmod(poly const &a,poly const &b){
	    int n=a.size(),m=b.size();
	    if(n<m) return a;
	    poly p=b,q=a;
	    std::reverse(p.begin(),p.end());
	    std::reverse(q.begin(),q.end());
	    p.resize(n-m+1),q.resize(n-m+1);
	    q=mul(q,inv(p));
	    q.resize(n-m+1);
	    std::reverse(q.begin(),q.end());
	    q=mul(q,b);
	    poly res(m-1);
	    for(int i=0;i<m-1;i++) res[i]=(a[i]-q[i]+mod)%mod;
	    return res;
	}
	poly deriv(poly const &a) {
		int n = a.size();
		if (n==0) {
			poly ret(0);
			return ret;
		}
		poly ret(n-1);
		for (int i=0;i<n-1;++i) ret[i]=a[i+1]*(i+1ll)%mod;
		return ret;
	}
	poly inter(poly const &a) {
		int n = a.size();
		poly ret(n+1);
		static int fact[1<<18],ifact[1<<18];
		fact[0]=1;for (int i=1;i<=n;++i) fact[i]=1ll*fact[i-1]*i%mod;
		ifact[n]=ksm(fact[n],mod-2);for (int i=n-1;i>=0;--i) ifact[i]=ifact[i+1]*(i+1ll)%mod;
		for (int i=1;i<=n;++i) ret[i]=a[i-1]*1ll*ifact[i]%mod*fact[i-1]%mod;
		return ret;
	}
	poly ln(poly const &a) {
		poly ret = inter(mul(deriv(a),inv(a)));
		ret.resize(a.size());
		return ret;
	}
	poly exp(poly const &a) {
		int n = a.size();
		poly st;
		while (n>1) st.push_back(n),n=(n+1)/2;
		int l2;for (l2=0;(1<<l2)<=n;l2++);l2=1<<(l2+1);
		poly ret(1),b;ret[0]=1;
		for (int i=st.size()-1,len;i>=0;--i) {
			len=st[i];
			ret.resize(len);
			b=ln(ret);b.resize(len);
			for (int i=0;i<len;++i)
				b[i]=a[i]>=b[i]?a[i]-b[i]:a[i]-b[i]+mod;
			b[0]=(b[0]+1)%mod;
			ret=mul(ret,b);
			ret.resize(len);
		}
		ret.resize(n);
		return ret;
	}
}
int n,e[S],k;
inline void readk()
{
	char c=getchar();
	while (c<'0' || c>'9') c=getchar();
	while (c>='0' && c<='9')
	{
		k=(k*10ll+(c^48))%mod;
		c=getchar();
	}
}
int main()
{
	scanf("%d",&n);
	poly e(n);
	for (int i=0,x;i<n;++i)
		scanf("%d",&x),e[i]=x;
	e = _P::exp(e);
	for (int i=0;i<n;++i)
		printf("%d ",e[i]);
	return 0;
}

```

# å¤šé¡¹å¼å¼€æ ¹

$$
G(X)=\frac{F(x)+H^2(x)}{2H(x)},when\\
H^2(x)\equiv F(x) (\mod x^{\lceil \frac{n}{2}\rceil})\\
G^2(x)\equiv F(x) (\mod x^n)
$$

```cpp
int main()
{
	scanf("%d",&n);k=ksm(2,mod-2);
	for (int i=0;i<n;++i)
		scanf("%d",e+i);
	int l2;for (l2=0;(1<<l2)<=n;++l2);++l2;
	l2=1<<l2;
	_P::ln(e,e,l2);
	for (int i=0;i<l2;++i)
		e[i]=1ll*e[i]*k%mod;
	_P::exp(e,e,l2);
	for (int i=0;i<n;++i)
		printf("%d ",e[i]);
	return 0;
}
```

# åäºŒé‡è®¡æ•°æ³•

ä¾ç„¶æ˜¯ã€Šç»„åˆæ•°å­¦ã€‹ä¸Šæ¬è¿çš„è£¸é¢˜ï¼ˆ
å¥½äº†è¯ä¸å¤šè¯´ï¼Œä¸‹é¢æ˜¯é¢˜è§£ã€‚

------

## 1ï¼šçƒä¸åŒï¼Œç›’å­ä¸åŒï¼Œæ— å…¶ä»–é™åˆ¶
æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œæ˜¾ç„¶ä¸º $m^n$ã€‚

## 2ï¼šçƒä¸åŒï¼Œç›’å­ä¸åŒï¼Œæ¯ä¸ªç›’å­è‡³å¤šè£…ä¸€ä¸ªçƒ
ä¾æ¬¡å–çƒè£…è¿›ç›’å­ï¼Œæ¯æ¬¡æ–¹æ¡ˆæ•°éƒ½å°‘ä¸€ç§ï¼Œä¹˜èµ·æ¥ç­”æ¡ˆä¸º $m^\underline{n}$ã€‚

## 3ï¼šçƒä¸åŒï¼Œç›’å­ä¸åŒï¼Œæ¯ä¸ªç›’å­è‡³å°‘è£…ä¸€ä¸ªçƒ
è¿™é‡Œè¦æ±‚ç›’å­éƒ½éç©ºï¼Œæ ¹æ®ç¬¬äºŒç±» Stirling æ•°çš„å®šä¹‰ï¼Œç­”æ¡ˆä¸º $\{n,m\}\times m!$ã€‚
è¿™é‡Œé¡ºä¾¿è¯´ä¸€ä¸‹ç¬¬äºŒç±» Stirling æ•°çš„ç®—æ³•ã€‚
é€‰å‡º $k$ ä¸ªç›’å­éç©ºï¼Œç„¶åæŠŠ $n$ ä¸ªçƒè£…è¿›å»ï¼Œè¿™ $k$ ä¸ªç›’å­è¿˜å¯ä»¥éšä¾¿æ’åˆ—ï¼ŒåŠ èµ·æ¥å¾—åˆ°ï¼š
$$
m^n = \sum_{k=0}^m \binom{m}{k} \{n,k\} k!
$$

äºŒé¡¹å¼åæ¼”å¯å¾—ï¼ˆå…¶å®å°±æ˜¯å®¹æ–¥ï¼‰ï¼š

$$
\{n,m\} = \frac{1}{m!}\sum_{k=0}{m} \binom{m}{k} (-1)^{m-k} k^n

= \sum_{k=0}^m \frac{k^n}{k!} \times \frac{(-1)^{m-k}} {(m-k)!}
$$
## 4ï¼šçƒä¸åŒï¼Œç›’å­ç›¸åŒï¼Œæ— å…¶ä»–é™åˆ¶
æ ¹æ® 3 çš„å¼å­ï¼Œç›´æ¥å·ç§¯è®¡ç®—å‡º n å›ºå®šçš„æ‰€æœ‰ç¬¬äºŒç±» Stirling æ•°ï¼Œæ˜¾ç„¶åŠ èµ·æ¥å°±æ˜¯ç­”æ¡ˆã€‚
## 5ï¼šçƒä¸åŒï¼Œç›’å­ç›¸åŒï¼Œæ¯ä¸ªç›’å­è‡³å¤šè£…ä¸€ä¸ªçƒ
è¿™ä¸ªå°±æ˜¯æ¥æç¬‘çš„ï¼Œï¼Œç”±äºç›’å­ç›¸åŒä¸”æœ€å¤šæ”¾ä¸€ä¸ªçƒï¼Œæ— è®ºæ€ä¹ˆè£…ï¼Œéƒ½å¯ä»¥æ’åˆ—ç›’å­å¾—åˆ°åŒä¸€ç§æ–¹æ¡ˆï¼Œæ‰€ä»¥ç­”æ¡ˆä¸º $[ğ‘›â©½ğ‘š]$ã€‚

## 6ï¼šçƒä¸åŒï¼Œç›’å­ç›¸åŒï¼Œæ¯ä¸ªç›’å­è‡³å°‘è£…ä¸€ä¸ªçƒ
ç¬¬äºŒç±» Stirling æ•°å°±æ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼Œä¸ç”¨æˆ‘è¯´ä»€ä¹ˆäº†å§ã€‚

## 7ï¼šçƒç›¸åŒï¼Œç›’å­ä¸ç›¸åŒï¼Œæ— å…¶ä»–é™åˆ¶
ç°åœ¨çƒéƒ½ç›¸åŒï¼Œæ¯ä¸ªç›’å­éƒ½åªçœ‹çƒçš„æ•°é‡ã€‚
æ¯ä¸ªç›’å­è£…è¿›ä»»æ„ä¸ªçƒéƒ½åªæœ‰ä¸€ç§æ–¹æ¡ˆï¼Œç”Ÿæˆå‡½æ•°ä¸º $\frac{1}{1-x}$ã€‚
äºæ˜¯ç­”æ¡ˆä¸ºï¼š


$$
[x^n]\frac{1}{1-x}^ğ‘š=\binom{n+m-1}{n}
$$

## 8ï¼šçƒç›¸åŒï¼Œç›’å­ä¸ç›¸åŒï¼Œæ¯ä¸ªç›’å­è‡³å¤šè£…ä¸€ä¸ªçƒ
ä» m ä¸ªç›’å­é‡Œé¢é€‰å‡º n ä¸ªæ¥è£…çƒï¼Œç­”æ¡ˆè‡ªç„¶ä¸º$\binom{m}{n} (ğ‘šğ‘›)$ ã€‚

## 9Lçƒç›¸åŒï¼Œç›’å­ä¸ç›¸åŒï¼Œæ¯ä¸ªç›’å­è‡³å°‘è£…ä¸€ä¸ªçƒ
æ¯ä¸ªç›’å­éƒ½è‡³å°‘è£…ä¸€ä¸ªäº†ï¼Œæ–¹æ¡ˆçš„ç”Ÿæˆå‡½æ•°å°±å˜ä¸º$\frac{x}{1-x}$

ç­”æ¡ˆä¸º$\binom{n-1}{m-1}$ã€‚

## 10ï¼šçƒç›¸åŒï¼Œç›’å­ç›¸åŒï¼Œæ— å…¶ä»–é™åˆ¶
~~å‰é¢éƒ½æ˜¯åŸºç¡€ï¼Œä¸‹é¢æ‰æ˜¯é‡ç‚¹~~

ç”±äºçƒä¸ç›’å­éƒ½æ²¡æœ‰åŒºåˆ†ï¼Œä¸éš¾æƒ³åˆ°å°†å…¶ç­‰ä»·ä¸ºåˆ†æ‹†æ•°çš„é—®é¢˜ï¼š

> å°† $n$ æ‹†åˆ†ä¸º $m$ ä¸ªæ— åºçš„æ­£æ•´æ•°çš„æ–¹æ¡ˆæ•° $p(n,m)$

ç›´æ¥åšå¥½åƒå¾ˆéš¾ï¼Œè¿™é‡Œå¼•å…¥ä¸€ä¸ªå« Ferrers å›¾çš„ä¸œè¥¿ã€‚

ä¸€ä¸ªåˆ†æ‹†çš„ Ferrers å›¾ï¼Œæ˜¯æŠŠåˆ†æ‹†å‡ºçš„æ¯ä¸€é¡¹ï¼Œç”¨ç‚¹ï¼ˆæˆ–æ–¹æ ¼ï¼‰ç»„æˆçš„è¡Œæ¥è¡¨ç¤ºã€‚ä¸€èˆ¬åˆ†æ‹†å†™ä¸ºé€’å‡æ­£æ•´æ•°å’Œï¼Œæ‰€ä»¥ Ferrers å›¾ä¹Ÿç”¨é•¿åº¦é€’å‡çš„è¡Œæ¥è¡¨ç¤ºã€‚

å¾ˆå®¹æ˜“å‘ç°ï¼ŒFerrers å›¾ä¸åˆ†æ‹†ä¹‹é—´æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚
å¦‚ 1212 çš„ä¸€ä¸ªåˆ†æ‹† 12=5+4+2+112=5+4+2+1 çš„ Ferrers å›¾å¦‚ä¸‹ï¼šï¼ˆç•¥ï¼‰4

> å°† ğ‘› æ‹†åˆ†ä¸ºè‹¥å¹²ä¸ªä¸è¶…è¿‡ ğ‘š çš„æ­£æ•´æ•°çš„æ–¹æ¡ˆæ•°ç­‰äº ğ‘(ğ‘›,ğ‘š)ã€‚

ç„¶åå¾—åˆ° ğ‘(ğ‘›,ğ‘š) çš„è®¡ç®—æ–¹æ³•ï¼š

ğ‘(ğ‘›,ğ‘š)=[ğ‘¥ğ‘›âˆ’ğ‘š]âˆğ‘–=1ğ‘š11âˆ’ğ‘¥ğ‘–*p*(*n*,*m*)=[*x**n*âˆ’*m*]*i*=1âˆ*m*1âˆ’*x**i*1

ç”±äºè¦æ±‚æ˜¯æ­£æ•´æ•°ä¸å¤ªå¥½æï¼Œå…ˆç»™æ¯ä¸ªç›’å­åˆ†é…ä¸€ä¸ªçƒï¼Œå°±åŒ–ä¸ºäº†æ‹†åˆ†æˆè‡ªç„¶æ•°ã€‚
è¿™æ˜¯ä¸ªç»å…¸å½¢å¼ï¼Œå¤šé¡¹å¼ expâ¡ è§£å†³ã€‚
å› ä¸ºè¿™é‡Œè¦æ‹†åˆ†æˆè‡ªç„¶æ•°ï¼Œä¸ç”¨æå‰åˆ†é…ï¼Œæ‰€ä»¥ç­”æ¡ˆè¦å–ä¸Šé¢é‚£ä¸ªå¤šé¡¹å¼çš„ ğ‘›*n* æ¬¡é¡¹ï¼Œè€Œé ğ‘›âˆ’ğ‘š*n*âˆ’*m*ã€‚

### XIXIï¼š
åŒ Vï¼Œç­”æ¡ˆä¸º [ğ‘›â©½ğ‘š][*n*â©½*m*]ã€‚

### XIIï¼š
æ˜¾ç„¶ç­‰äº ğ‘(ğ‘›,ğ‘š)*ã€‚

------

æ€»æ—¶é—´å¤æ‚åº¦ä¸º Î˜(ğ‘›logâ¡ğ‘›)Î˜(*n*log*n*)ï¼ˆè¿™é‡Œè®¤ä¸º ğ‘›,ğ‘š*n*,*m* åŒé˜¶ï¼‰ã€‚